<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" main="IE=edge">
  <title>WebWidgetRouter demo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <base href="/router-demo/" />
</head>

<body>

  <web-widget src="/nav.widget.js"></web-widget>
  <web-router>
    <web-route path="" title="首页" element="web-widget" src="/index.widget.js" data-id="#43243242"></web-route>
    <web-route path="news" element="web-widget" src="/news.widget.js" data-id="#ttrt"></web-route>
    <web-route path="about" element="web-widget" title="关于" src="/about.widget.js" data-id="#367" data-about="一个演示"></web-route>
    <web-route path="vue-router/*" element="web-widget" src="/vue-router.widget.js" data-id="#367" data-vue="vue-router demo"></web-route>
    <web-route path="test" element="test-element">
      <template>
        Hello wrold
      </template>
    </web-route>
    <web-route path="*" element="web-widget" src="/404.widget.js"></web-route>
    <web-outlet></web-outlet>
  </web-router>

  <script type="module">
    import { HTMLWebWidgetElement } from '../../container/src/index.js';
    import { HTMLWebRouterElement} from '../src/index.js';

    function defineHook(target, name, callback) {
      return Reflect.defineProperty(
        target,
        name,
        callback(Reflect.getOwnPropertyDescriptor(target, name))
      );
    }

    defineHook(HTMLWebWidgetElement.prototype, 'createDependencies', ({ value }) => ({
      value() {
        const dependencies = value.apply(this, arguments);
        defineHook(dependencies, 'router', () => ({
          get: () => this.router
        }));
        defineHook(dependencies, 'route', () => ({
          get: () => this.route
        }));
        return dependencies;
      }
    }));
  </script>
</body>

</html>